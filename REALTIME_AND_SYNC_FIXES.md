# ๐ง ุฅุตูุงุญุงุช Realtime ู Sync API

## ๐ ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง

### 1. **Realtime Subscription Errors**
- โ **ุงููุดููุฉ**: ุฃุฎุทุงุก Realtime ุชุธูุฑ ูู Console ุญุชู ูู ูุงูุช ุฑุณุงุฆู ูุฌุงุญ
- โ **ุงูุญู**: ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุชุฌุงูู ุฑุณุงุฆู ุงููุฌุงุญ ูุซู "Subscribed to PostgreSQL"

### 2. **Sync API 400 Bad Request**
- โ **ุงููุดููุฉ**: Sync API ูุฑุฌูุน 400 Bad Request ุจุฏูู ูุนูููุงุช ูุงุถุญุฉ
- โ **ุงูุญู**: ุฅุถุงูุฉ logging ุฃูุถู ูุชุชุจุน ุงููุดููุฉ

---

## ๐ง ุงูุชุบููุฑุงุช

### 1. **hooks/use-locations.ts**
- โ ุชุญุณูู ูุนุงูุฌุฉ `system` errors ูู Realtime
- โ ุฅุถุงูุฉ `errorString` check ูุชุฌุงูู ุฑุณุงุฆู ุงููุฌุงุญ ุงููุฎููุฉ
- โ ุชุญุณูู ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุชูููู (configuration errors)

### 2. **components/locations/locations-overview-tab.tsx**
- โ ุฅุถุงูุฉ `console.log` ูุชุชุจุน `gmbAccountId` ู `requestBody`
- โ ุชุญุณูู ูุนุงูุฌุฉ ุฎุทุฃ 400 Bad Request
- โ ุฅุถุงูุฉ logging ุฃูุถู ููุชุดุฎูุต

### 3. **lib/hooks/use-dashboard-realtime.ts**
- โ ุชุญุณูู ูุนุงูุฌุฉ `system` errors ูู Realtime
- โ ุฅุถุงูุฉ `errorString` check ูุชุฌุงูู ุฑุณุงุฆู ุงููุฌุงุญ ุงููุฎููุฉ
- โ ุชุญุณูู ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุชูููู

---

## ๐ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### ูุจู ุงูุฅุตูุงุญ:
- โ `โ Realtime subscription error: โบ Object` (ุญุชู ูู ูุงู ูุฌุงุญ)
- โ `โ POST https://www.nnh.ae/api/gmb/sync 400 (Bad Request)` (ุจุฏูู ุชูุงุตูู)

### ุจุนุฏ ุงูุฅุตูุงุญ:
- โ ุฑุณุงุฆู Realtime ุงููุฌุงุญ ูุง ุชุธูุฑ ูุฃุฎุทุงุก
- โ ุฃุฎุทุงุก Sync ุชุธูุฑ ูุน ุชูุงุตูู ูุงููุฉ ููุชุดุฎูุต
- โ Console ูุธูู ูู ุงูุฃุฎุทุงุก ุงูุฒุงุฆูุฉ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. **ุงุฎุชุจุงุฑ Realtime:**
- ุงูุชุญ Console ูู ุงููุชุตูุญ
- ูุฌุจ ุฃู ุชุฑู: `โ Locations realtime subscribed`
- ูุง ูุฌุจ ุฃู ุชุฑู: `โ Realtime subscription error` (ูุฑุณุงุฆู ุงููุฌุงุญ)

### 2. **ุงุฎุชุจุงุฑ Sync:**
- ุงุถุบุท ุนูู ุฒุฑ "Sync"
- ุงูุชุญ Console
- ูุฌุจ ุฃู ุชุฑู: `Starting sync for account: [account-id]`
- ูุฌุจ ุฃู ุชุฑู: `Sync request body: { accountId: "...", syncType: "full" }`
- ุฅุฐุง ูุงู ููุงู ุฎุทุฃ 400ุ ูุฌุจ ุฃู ุชุฑู ุชูุงุตูู ูู Console

---

## ๐ ููุงุญุธุงุช

### ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู:

1. **Realtime Errors:**
   - ุชุฃูุฏ ูู ุฃู Realtime ููุนูู ูู Supabase
   - ุชุฃูุฏ ูู ุฃู RLS policies ุตุญูุญุฉ

2. **Sync 400 Error:**
   - ุชุญูู ูู Console ููู `gmbAccountId`
   - ุชุญูู ูู ุฃู `accountId` ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ูุฏูู ุตูุงุญูุฉ ููู account

---

## โ ุงูุฎูุงุตุฉ

- โ ุชุญุณูู ูุนุงูุฌุฉ ุฃุฎุทุงุก Realtime
- โ ุฅุถุงูุฉ logging ุฃูุถู ูู Sync
- โ ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 2025-01-05

